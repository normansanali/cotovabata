<!doctype html><html lang=en><head><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=referrer content="no-referrer"><meta name=description content="Through the advent of Meltdown and Spectre, there is a heightened element of nervousness around potential security flaws in modern high-performance processors, especially those that deal with the core and critical components of company business and international infrastructure. Today, CTS-Labs, a security company based in Israel, has published a whitepaper identifying four classes of potential"><meta name=robots content="index,follow,noarchive"><link href="https://fonts.googleapis.com/css?family=Open+Sans:400|Old+Standard+TT:400&display=swap" rel=stylesheet media=print type=text/css onload='this.media="all"'><title>Security Researchers Publish Ryzen Flaws, Gave AMD 24 hours Prior Notice</title><link rel=canonical href=./security-researchers-publish-ryzen-flaws-gave-amd-24-hours-to-respond.html><style>*{border:0;font:inherit;font-size:100%;vertical-align:baseline;margin:0;padding:0;color:#000;text-decoration-skip:ink}body{font-family:open sans,myriad pro,Myriad,sans-serif;font-size:17px;line-height:160%;color:#1d1313;max-width:700px;margin:auto}p{margin:20px 0}a img{border:none}img{margin:10px auto;max-width:100%;display:block}.left-justify{float:left}.right-justify{float:right}pre,code{font:12px Consolas,liberation mono,Menlo,Courier,monospace;background-color:#f7f7f7}code{font-size:12px;padding:4px}pre{margin-top:0;margin-bottom:16px;word-wrap:normal;padding:16px;overflow:auto;font-size:85%;line-height:1.45}pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}pre code{display:inline;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}pre code::before,pre code::after{content:normal}em,q,em,dfn{font-style:italic}.sans,html .gist .gist-file .gist-meta{font-family:open sans,myriad pro,Myriad,sans-serif}.mono,pre,code,tt,p code,li code{font-family:Menlo,Monaco,andale mono,lucida console,courier new,monospace}.heading,.serif,h1,h2,h3{font-family:old standard tt,serif}strong{font-weight:600}q:before{content:"\201C"}q:after{content:"\201D"}del,s{text-decoration:line-through}blockquote{font-family:old standard tt,serif;text-align:center;padding:50px}blockquote p{display:inline-block;font-style:italic}blockquote:before,blockquote:after{font-family:old standard tt,serif;content:'\201C';font-size:35px;color:#403c3b}blockquote:after{content:'\201D'}hr{width:40%;height:1px;background:#403c3b;margin:25px auto}h1{font-size:35px}h2{font-size:28px}h3{font-size:22px;margin-top:18px}h1 a,h2 a,h3 a{text-decoration:none}h1,h2{margin-top:28px}#sub-header,.date{color:#403c3b;font-size:13px}#sub-header{margin:0 4px}#nav h1 a{font-size:35px;color:#1d1313;line-height:120%}.posts_listing a,#nav a{text-decoration:none}li{margin-left:20px}ul li{margin-left:5px}ul li{list-style-type:none}ul li:before{content:"\00BB \0020"}#nav ul li:before,.posts_listing li:before{content:'';margin-right:0}#content{text-align:left;width:100%;font-size:15px;padding:60px 0 80px}#content h1,#content h2{margin-bottom:5px}#content h2{font-size:25px}#content .entry-content{margin-top:15px}#content .date{margin-left:3px}#content h1{font-size:30px}.highlight{margin:10px 0}.posts_listing{margin:0 0 50px}.posts_listing li{margin:0 0 25px 15px}.posts_listing li a:hover,#nav a:hover{text-decoration:underline}#nav{text-align:center;position:static;margin-top:60px}#nav ul{display:table;margin:8px auto 0}#nav li{list-style-type:none;display:table-cell;font-size:15px;padding:0 20px}#links{display:flex;justify-content:space-between;margin:50px 0 0}#links :nth-child(1){margin-right:.5em}#links :nth-child(2){margin-left:.5em}#not-found{text-align:center}#not-found a{font-family:old standard tt,serif;font-size:200px;text-decoration:none;display:inline-block;padding-top:225px}@media(max-width:750px){body{padding-left:20px;padding-right:20px}#nav h1 a{font-size:28px}#nav li{font-size:13px;padding:0 15px}#content{margin-top:0;padding-top:50px;font-size:14px}#content h1{font-size:25px}#content h2{font-size:22px}.posts_listing li div{font-size:12px}}@media(max-width:400px){body{padding-left:20px;padding-right:20px}#nav h1 a{font-size:22px}#nav li{font-size:12px;padding:0 10px}#content{margin-top:0;padding-top:20px;font-size:12px}#content h1{font-size:20px}#content h2{font-size:18px}.posts_listing li div{font-size:12px}}@media(prefers-color-scheme:dark){*,#nav h1 a{color:#fdfdfd}body{background:#121212}pre,code{background-color:#262626}#sub-header,.date{color:#bababa}hr{background:#ebebeb}}</style></head><body><section id=nav><h1><a href=./index.html>ZingBlog</a></h1><ul><li><a href=./index.xml>Rss</a></li><li><a href=./sitemap.xml>Sitemap</a></li></ul></section><section id=content><h1>Security Researchers Publish Ryzen Flaws, Gave AMD 24 hours Prior Notice</h1><div id=sub-header>August 2024 · 10 minute read</div><div class=entry-content><img src=https://cdn.statically.io/img/images.anandtech.com/doci/12525/combo_678x452.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><p>Through the advent of Meltdown and Spectre, there is a heightened element of nervousness around potential security flaws in modern high-performance processors, especially those that deal with the core and critical components of company business and international infrastructure. Today, CTS-Labs, a security company based in Israel, has published a whitepaper identifying four classes of potential vulnerabilities of the Ryzen, EPYC, Ryzen Pro, and Ryzen Mobile processor lines. AMD is in the process of responding to the claims, but was only given 24 hours of notice rather than the typical 90 days for standard vulnerability disclosure. No official reason was given for the shortened time.</p><p>As of 3/13 at 5:40pm ET, AMD has since opened <a href=#>a section on its website</a> to respond to these issues. At present, the statement says:</p><p><b>"We have just received a report from a company called CTS Labs claiming there are potential security vulnerabilities related to certain of our processors. We are actively investigating and analyzing its findings. This company was previously unknown to AMD and we find it unusual for a security firm to publish its research to the press without providing a reasonable amount of time for the company to investigate and address its findings. At AMD, security is a top priority and we are continually working to ensure the safety of our users as potential new risks arise. We will update this blog as news develops."</b></p><p>At this point AMD has not confirmed any of the issues brought forth in the CTS-Labs whitepaper, so we cannot confirm in the findings are accurate. It has been brought to our attention that some press were pre-briefed on the issue, perhaps before AMD was notified, and that the website that CTS-Labs has setup for the issue was registered on February 22nd, several weeks ago. Given the level of graphics on the site, it does look like a planned ‘announcement’ has been in the works for a little while, seemingly with little regard for AMD’s response on the issue. This is compared to Meltdown and Spectre, which was shared among the affected companies several months before a planned public disclosure. CTS-Labs has also hired a PR firm to deal with incoming requests for information, which is also an interesting avenue to the story, as this is normally not the route these security companies take. CTS-Labs is a security focused research firm, but does not disclose its customers or research leading to this disclosure. CTS-Labs was started in 2017, and this is their first public report.</p><p>CTS-Labs’ claims revolve around AMD’s Secure Processor and Promontory Chipset, and fall into four main categories, which CTS-Labs has named for maximum effect. Each category has sub-sections within.</p><h3><strong>MasterKey 1, 2, and 3</strong></h3><p>MasterKey is an exploit that allows for arbitrary code execution within the secure processor of the CPU, but requires the attacker to re-flash the BIOS with an update that attacks the Arm Cortex A5 at the heart of the secure processor. In one version of MasterKey, the BIOS update uses metadata to exploit the vulnerability, but the goal is to bypass AMD’s Hardware Validated Boot (HVM). The impact of MasterKey would allow security features to be disabled, such as the Firmware Trusted Platform Module or Secure Encrypted Virtualization. This could lead to hardware-based random attacks. CTS-Labs cite that American Megatrends, a common BIOS provider for Ryzen systems, makes a BIOS re-flash very easy, assuming the attacker has a compatible BIOS.</p><table border=0 width=85%><tbody readability=1><tr class=tlblue><td>&nbsp;</td><td>Impact</td><td>EPYC</td><td>Ryzen</td><td>Ryzen Pro</td><td>Ryzen Mobile</td></tr><tr readability=2><td class=tlgrey>MasterKey-1</td><td rowspan=3>Disable Security Features<br>within<br>AMD Secure Processor</td><td rowspan=3><strong>Yes</strong></td><td rowspan=3><strong>Yes</strong></td><td rowspan=3>Maybe</td><td rowspan=3>Maybe</td></tr><tr><td class=tlgrey>MasterKey-2</td></tr><tr><td class=tlgrey>MasterKey-3</td></tr></tbody></table><p>CTS-Labs state that MasterKey-1 and Masterkey-2 has been successfully exploited on EPYC and Ryzen, but only theorized on Ryzen Pro and Ryzen Mobile by examining the code. Masterkey-3 has not been attempted. Protection comes via preventing unauthorized BIOS updates, although if Ryzenfall compromised system may bypass this.</p><h3><strong>Chimera HW and Chimera SW</strong></h3><p>The Chimera exploit focuses on the Promontory chipset, and hidden manufacturer backdoors that allow for remote code execution. CTS-Labs cites that ASMedia, the company behind the chipset, has been fallen foul of the FTC due to security vulnerabilities in its hardware.</p><table border=0 width=85%><tbody><tr class=tlblue><td>&nbsp;</td><td>Impact</td><td>EPYC</td><td>Ryzen</td><td>Ryzen<br>Pro</td><td>Ryzen<br>Mobile</td></tr><tr><td class=tlgrey>Chimera HW</td><td rowspan=2>Chipset code execution</td><td rowspan=2>No</td><td rowspan=2><strong>Yes</strong></td><td rowspan=2><strong>Yes</strong></td><td rowspan=2>No</td></tr><tr><td class=tlgrey>Chimera SW</td></tr></tbody></table><p>A successful exploit allows malicious code that can attack any device attached through the chipset, such as SATA, USB, PCIe, and networking. This would allow for loggers, or memory protection bypasses, to be put in place. It is cited that malware could also be installed and abuse the Direct Memory Access (DMA) engine of the chipset, leading to an operating system attack. CTS-Labs has said that they have successfully exploited Chimera on Ryzen and Ryzen Pro, by using malware running on a local machine with elevated administrator privileges and a digitally signed driver. It was stated that a successful firmware attack would be ‘notoriously difficult to detect or remove’.</p><h3><strong>Ryzenfall 1, 2, 3, and 4</strong></h3><p>The Ryzenfall exploit revolves around AMD Secure OS, the operating system for the secure processor. As the secure processor is an Arm Cortex A5, it leverages ARM TrustZone, and is typically responsible for most of the security on the chip, including passwords and cryptography.</p><table border=0 width=85%><tbody readability=1><tr class=tlblue><td>&nbsp;</td><td>Impact</td><td>EPYC</td><td>Ryzen</td><td>Ryzen<br>Pro</td><td>Ryzen<br>Mobile</td></tr><tr><td class=tlgrey>Ryzenfall-1</td><td>VTL-1 Memory Write</td><td>No</td><td><strong>Yes</strong></td><td><strong>Yes</strong></td><td><strong>Yes</strong></td></tr><tr><td class=tlgrey>Ryzenfall-2</td><td>Disable SMM Protection</td><td>No</td><td><strong>Yes</strong></td><td><strong>Yes</strong></td><td>No</td></tr><tr readability=2><td class=tlgrey>Ryzenfall-3</td><td>VTL-1 Memory Read<br>SMM Memory Read (req R-2)</td><td>No</td><td><strong>Yes</strong></td><td><strong>Yes</strong></td><td>No</td></tr><tr><td class=tlgrey>Ryzenfall-4</td><td>Code Execution on SP</td><td>No</td><td><strong>Yes</strong></td><td>Maybe</td><td>No</td></tr></tbody></table><p>CTS-Labs states that the Ryzenfall exploit allows the attacker to access protected memory regions that are typically sealed off from hardware, such as the Windows Isolated User Mode and Isolated Kernel Mode, the Secure Management RAM, and AMD Secure Processor Fenced DRAM. A successful attack, via elevated admin priveledges and a vendor supplied driver, are stated to allow protected memory reads and writes, disabling of secure memory protection, or arbitrary code execution.</p><h3><strong>Fallout 1, 2, and 3</strong></h3><p>Fallout applies to EPYC processors only, and is similar to Ryzenfall. In fact, the way that CTS-Labs describes the vulnerability, the results are identical to Ryzenfall, but relies on compromising the Boot Loader in the secure processor. Again, this is another attack that requires elevated administrator access and goes through a signed driver, and like Ryzenfall allows access to protected memory regions.</p><table border=0 width=85%><tbody readability=1><tr class=tlblue><td>&nbsp;</td><td>Impact</td><td>EPYC</td><td>Ryzen</td><td>Ryzen<br>Pro</td><td>Ryzen<br>Mobile</td></tr><tr><td class=tlgrey>Fallout-1</td><td>VTL-1 Memory Write</td><td><strong>Yes</strong></td><td>No</td><td>No</td><td>No</td></tr><tr><td class=tlgrey>Fallout-2</td><td>Disable SMM Protection</td><td><strong>Yes</strong></td><td>No</td><td>No</td><td>No</td></tr><tr readability=2><td class=tlgrey>Fallout-3</td><td>VTL-1 Memory Read<br>SMM Memory Read (req F-2)</td><td><strong>Yes</strong></td><td>No</td><td>No</td><td>No</td></tr></tbody></table><p>CTS-Labs states this as a separate name on the basis that it can bypass Microsoft Virtualization-based security, open up the BIOS to flashing, and allow malware to be injected into protected memory that is outside the scope of most security solutions.</p><h3><strong>What Happens Now</strong></h3><p>As this news went live, we got in contact with AMD, who told us have an internal team working on the claims of CTS-Labs. The general feeling is that they have been somewhat blindsided by all of this, given the limited time from notice to disclosure, and are using the internal team to validate the claims made. CTS-Labs state that it has shared the specific methods it used to identify and exploit the processors with AMD, as well as sharing the details with select security companies and the US regulators.</p><p>All of the exploits require elevated administrator access, with MasterKey going as far as a BIOS reflash on top of that. CTS-Labs goes on the offensive however, stating that it ‘raises concerning questions regarding security practices, auditing, and quality controls at AMD’, as well as saying that the ‘vulnerabilities amount to complete disregard of fundamental security principles’. This is very strong wording indeed, and one might have expected that they might have waited for an official response. The other angle is that given Spectre/Meltdown, the '1-day' disclosure was designed for the maximum impact. Just enough time to develop a website, anyway.</p><p>CTS-Labs is very forthright with its statement, having seemingly pre-briefed some press at the same time it was notifying AMD, and directs questions to its PR firm. The full whitepaper can be seen <a href=#>here</a>, at safefirmware.com, a website registered on 6/9 with no home page and seemingly no link to CTS-Labs. Something doesn't quite add up here.</p><p>AMD have us on speed-dial for when an official statement is released.</p><p><strong>Sources: AMD, <a href=#>CTS-Labs</a></strong></p><p><b>Update 3/13 5:40pm ET</b></p><p>Reported over at <a href=#>Motherboard</a> are a few new elements to the story.</p><p>Dan Guido, founder of security firm Trail of Bits, was contacted by CTS Labs last week to confirm the exploits and the code.</p><p>"Each of them works as described,",</p><p>Stated Guido. Guido has confirmed to AnandTech that Trail of Bits has had no prior contact with CTS-Labs, stating that</p><p>"they found us through a mutual friend".</p><p>Guido goes on to say that CTS-Labs</p><p>"sought us out because they were concerned about the validity of their findings".</p><p>In a tweet, Guido goes on to say that Trail of Bits was paid for their research time, <a href=#>clarifying</a>&nbsp;further that&nbsp;</p><p>"It was driven by curiosity first and a favor. However, once we received the technical report and fielded their first set of questions, we realized it went beyond a favor. We anticipated 1 bug, not 13, so we asked to get paid."</p><p><a href=#>Reuters</a> has published that Trail of Bits were paid $16000 for the time spent reviewing the code.</p><p>Motherboard also stated that due to the escalated privileged required for these attacks, these are 'second stage' vulnerabilities, requiring the attacker to gain administrative access first before installing relevant (potentially undetectable) spying software on a network.</p><p>Also reported at Motherboard, CTS-Labs CEO, Ido Li On, has stated that the issues are</p><p>"very, very bad. This is probably as bad as it gets in the world of security,"</p><p>CTS-Labs decided to state to Motherboard when they notified AMD of the issue, but CFO Yaron Luk-Zilberman defended their timing decisions, calling it a "public interest disclosure". Luk-Zilberman is also quoted as saying</p><p>"We are letting the public know of these flaws but we are not putting out technical details and have no intention of putting out technical details, ever"</p><p>CTS-Labs has reached out to discuss the issue, but have not responded to my email.</p><p><b>Update 3/14 4:45am ET</b></p><p>We have arranged a call with CTS-Labs today.</p><p><b>Update 3/14 5:00am ET</b></p><p>Reported by <a href=#>Ars Technica</a>, a second security firm has now spoken publicly about being contacted by CTS-Labs for verification of the vulnerabilities. Gadi Evron, CEO of Cymmetria, stated in a <a href=#>series of tweets</a> that:</p><li>He knows CTS-Labs and vouches for their technical capabilities, but has no knowledge of their business model</li><li>All the vulnerabilites do not require physical access (a simple exe is all that is needed)</li><li>Fallout does not require a reflash of the BIOS</li><li>CTS-Labs believes that the public has a right to know if a vendor they are using makes them vulnerable, which is why no substantial lead time was given.</li><p>Quoted by Ars is David Kanter, founder of Real World Technologies and industry consultant, who verifies that even though these are secondary stage attacks, they can still be highly important. David states that while</p><p>"All the exploits require root access - if someone already has root access to your system, you're already compromised. This is like if someone broke into your home and they got to install video cameras to spy on you".</p><p>Ars also quotes Dan Guido, who states that all that is needed to enable these exploits is the credentials of a single administrator:&nbsp;</p><p>"Once you have administrative rights, exploiting the bugs is unforunately not that complicated."</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7orrAp5utnZOde6S7zGiqoaenZH5zgZFuZqydk6q%2FqsDYZqmeq5WWv6S0xKuqZqill7mqv8dmqbKylaN6p7jAsKpmn5Grsm6tzJ1ka2xdnby2vtJmq6hloprAsbvNnQ%3D%3D</p></div><div id=links><a href=./straight-outta-compton-star-jason-mitchell-tossed-delta-flight.html>&#171;&nbsp;Straight Outta Compton Star Jason Mitchell Tossed From Delta Flight</a>
<a href=./jessica-lynn-parsons.html>Jessica Lynn Parsons&nbsp;&#187;</a></div></section><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>